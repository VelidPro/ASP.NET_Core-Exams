@model RS1_Ispit_asp.net_core.ViewModels.IspitniTerminDetaljiVM
@{
    ViewData["Title"] = "Detalji";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="row mt-5">
    <h3>Detalji ispita za predmet @Model.Predmet</h3>
    <hr/>
</div>
<div class="row">
    <div class="col-md-6">
        <div class="row pt-5">
            <div class="col-md-6">
                <label class="control-label" asp-for="Predmet"></label>
            </div>
            <div class="col-md-6">
                <input asp-for="Predmet" class="form-control" readonly />
            </div>
        </div>

        <div class="row pt-5">
            <div class="col-md-6">
                <label class="control-label" asp-for="Nastavnik"></label>
            </div>
            <div class="col-md-6">
                <input asp-for="Nastavnik" class="form-control" readonly />
            </div>
        </div>

        <div class="row pt-5">
            <div class="col-md-6">
                <label class="control-label" asp-for="SkolskaGodina"></label>
            </div>
            <div class="col-md-6">
                <input asp-for="SkolskaGodina" class="form-control" readonly />
            </div>
        </div>

        <div class="row pt-5">
            <div class="col-md-6">
                <label class="control-label" asp-for="Datum"></label>
            </div>
            <div class="col-md-6">
                <input asp-for="Datum" class="form-control" readonly />
            </div>
        </div>

        <div class="row pt-5">
            <div class="col-md-6">
                <label class="control-label" asp-for="Napomena"></label>
            </div>
            <div class="col-md-6">
                <textarea asp-for="Napomena" class="form-control" readonly></textarea>
            </div>
        </div>
    </div>
</div>
<hr/>
<div class="row mt-5">
    <h4>Polaganja ispita</h4>
    <hr/>
    <div class="col-md-6 col-ld-5 col-sm-12 mt-5">
        <table class="table table-striped">
            <thead>
            <tr>
                <th>Student</th>
                <th>Pristupio ispitu</th>
                <th class="text-center">Ocjena</th>
                <th>Akcija</th>
            </tr>
            </thead>
            <tbody>
            @foreach (var x in Model.Polaganja)
            {
                <tr>
                    <td>@x.Student</td>
                    <td>
                        <a id="@(string.Concat("Termin_", x.Id.Substring(x.Id.Length - 6, 5)))"
                           asp-action="TogglePristupioIspitu"
                           asp-controller="PolaganjeIspita"
                           asp-route-Id="@x.Id"
                           ajax-poziv="da"
                           ajax-toggler="da"
                           ajax-toggle-rezultat="@(string.Concat("Termin_", x.Id.Substring(x.Id.Length - 6, 5)))">
                            @(x.PristupioIspitu ? "Pristupio" : "Nije pristupio")

                        </a>
                    </td>
                    <td>
                        <div class="col-md-7" style="margin-left: 20%;">
                            @if (x.PristupioIspitu)
                            {
                                <input id="@(string.Concat("Ocjena_", x.Id.Substring(x.Id.Length - 6, 5)))"
                                       value="@(x.Ocjena == null ? "" : x.Ocjena.ToString())"
                                       class="form-control" min="5" max="10" type="number"
                                       ajax-poziv="da"
                                       ajax-notify="da"
                                       ajax-message="Uspjesna izmjena"
                                       ajax-append-parameter="da"
                                       ajax-append-parameter-name="ocjena"
                                       ajax-url="@Url.Action("Ocjena", "PolaganjeIspita", new {polaganjeId = x.Id})"/>
                            }
                        </div>

                    </td>
                    <td>
                        @if (x.PristupioIspitu && !Model.Zakljucan && DateTime.Now > Model.Datum)
                        {
                            <a asp-action="Uredi"
                               asp-controller="PolaganjeIspita"
                               asp-route-Id="@x.Id"
                               ajax-poziv="da"
                               ajax-rezultat="polaganjeEdit">Uredi</a>
                        }
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div>
</div>
<hr/>
<div class="row">
    <div class="col-md-3 col-lg-2 col-sm-12">
        <a class="btn btn-primary"
           asp-action="Dodaj" 
           asp-route-ispitniTerminId="@Model.Id"
           asp-controller="PolaganjeIspita"
           ajax-poziv="da"
           ajax-rezultat="novoPolaganje">Dodaj</a>

    </div>
</div>
<hr/>
<div class="row mt-10">
    <div class="col-md-4" id="polaganjeEdit"></div>
</div>
<div class="row mt-10">
    <div class="col-md-4" id="novoPolaganje"></div>
</div>

